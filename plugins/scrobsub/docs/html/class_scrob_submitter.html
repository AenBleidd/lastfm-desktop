<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>ScrobSubmitter Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.2 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
  </ul>
</div>
<div class="tabs">
  <ul>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul>
</div>
<h1>ScrobSubmitter Class Reference</h1><!-- doxytag: class="ScrobSubmitter" --><code>#include &lt;<a class="el" href="_scrob_submitter_8h-source.html">ScrobSubmitter.h</a>&gt;</code>
<p>
<a href="class_scrob_submitter-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_scrob_submitter.html#743e06902c0318679a3d272f2c0b606a">Encoding</a> { <b>ISO_8859_1</b>, 
<b>UTF_8</b>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef void(*)&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_scrob_submitter.html#1f22481471ffffa3d1677a81303c3ff1">StatusCallback</a> (int reqId, bool error, std::string msg, void *userData)</td></tr>

<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_scrob_submitter.html#bf93469f6106cafa21dc8c093629e13b">ScrobSubmitter</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_scrob_submitter.html#bc8808b8c6629975188417f5fdbc8856">~ScrobSubmitter</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_scrob_submitter.html#a35102b0accdf8f2edc2228da1cf47ff">Init</a> (const std::string &amp;pluginId, <a class="el" href="class_scrob_submitter.html#1f22481471ffffa3d1677a81303c3ff1">StatusCallback</a> callback, void *userData)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_scrob_submitter.html#9be66164b646c08bdf2f183af7f8a115">Term</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_scrob_submitter.html#2cc75a9528f6ba5feb79f22223945d33">Start</a> (std::string artist, std::string track, std::string album, std::string mbId, int length, std::string filename, <a class="el" href="class_scrob_submitter.html#743e06902c0318679a3d272f2c0b606a">Encoding</a> encoding=UTF_8)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_scrob_submitter.html#566a45131fe2b1420fe01281e0590722">Stop</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_scrob_submitter.html#96b594065992db4a25d5433ae6847997">Pause</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_scrob_submitter.html#eaa7bc7179e4a6c76bbb2a8ca7030aaf">Resume</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_scrob_submitter.html#22eaa73467e48cb23d69e4191b48c9e8">GetVersion</a> ()</td></tr>

<tr><td colspan="2"><br><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_scrob_submitter.html#2c86769b762ee18c647cd5a6645a579d">GetLogPath</a> ()</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Class for submitting tracks to the Last.fm client. It communicates with the client via a local socket.<p>
To use it, call Init on player startup passing the required parameters. This will launch the Last.fm client if it isn't already runnning and initialise the socket communication and worker thread.<p>
Then simply call functions Start, Stop, Pause and Resume in response to player events to communicate these events to the Last.fm client. They all operate asynchronously, i.e. they will return straight away so as to prevent hanging the calling thread if an operation takes some time. This shouldn't normally be the case but if the client is not running, it might take some time to discover that the socket is not open. The functions will return a request ID uniquely identifying the command just sent. When the request is finished, the status callback will be called with the ID as a parameter and a message of either "OK" or a description of the error if one occurred.<p>
It's important to call Term at shutdown to clean up all resources properly. 
<p>
<hr><h2>Member Typedef Documentation</h2>
<a class="anchor" name="1f22481471ffffa3d1677a81303c3ff1"></a><!-- doxytag: member="ScrobSubmitter::StatusCallback" ref="1f22481471ffffa3d1677a81303c3ff1" args="(int reqId, bool error, std::string msg, void *userData)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(*) <a class="el" href="class_scrob_submitter.html#1f22481471ffffa3d1677a81303c3ff1">ScrobSubmitter::StatusCallback</a>(int reqId, bool error, std::string msg, void *userData)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Callback function type for status reporting.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>reqId</em>&nbsp;</td><td>The request ID the message is in regards to. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>error</em>&nbsp;</td><td>True if an error occurred. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>msg</em>&nbsp;</td><td>Status message. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>userData</em>&nbsp;</td><td>The user data passed to Init. </td></tr>
  </table>
</dl>

</div>
</div><p>
<hr><h2>Member Enumeration Documentation</h2>
<a class="anchor" name="743e06902c0318679a3d272f2c0b606a"></a><!-- doxytag: member="ScrobSubmitter::Encoding" ref="743e06902c0318679a3d272f2c0b606a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="class_scrob_submitter.html#743e06902c0318679a3d272f2c0b606a">ScrobSubmitter::Encoding</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Text encoding used for track submissions. 
</div>
</div><p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="bf93469f6106cafa21dc8c093629e13b"></a><!-- doxytag: member="ScrobSubmitter::ScrobSubmitter" ref="bf93469f6106cafa21dc8c093629e13b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ScrobSubmitter::ScrobSubmitter           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Constructor 
</div>
</div><p>
<a class="anchor" name="bc8808b8c6629975188417f5fdbc8856"></a><!-- doxytag: member="ScrobSubmitter::~ScrobSubmitter" ref="bc8808b8c6629975188417f5fdbc8856" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ScrobSubmitter::~ScrobSubmitter           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Destructor 
</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="a35102b0accdf8f2edc2228da1cf47ff"></a><!-- doxytag: member="ScrobSubmitter::Init" ref="a35102b0accdf8f2edc2228da1cf47ff" args="(const std::string &amp;pluginId, StatusCallback callback, void *userData)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ScrobSubmitter::Init           </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>pluginId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_scrob_submitter.html#1f22481471ffffa3d1677a81303c3ff1">StatusCallback</a>&nbsp;</td>
          <td class="paramname"> <em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>userData</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Call this to initialise the class. Must be called before any tracks are submitted or things won't work. This function will also launch Last.fm if it isn't running.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pluginId</em>&nbsp;</td><td>Three-letter plugin code as assigned by Last.fm. Contact russ at last.fm to get one for your plugin. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>callback</em>&nbsp;</td><td>Function pointer for reporting result status of asynchronous operations. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>userData</em>&nbsp;</td><td>Pointer that will be passed back through the callback. Use for "this" pointer. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="9be66164b646c08bdf2f183af7f8a115"></a><!-- doxytag: member="ScrobSubmitter::Term" ref="9be66164b646c08bdf2f183af7f8a115" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ScrobSubmitter::Term           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Call this to terminate. Must be called in order for the socket thread to be shut down properly. 
</div>
</div><p>
<a class="anchor" name="2cc75a9528f6ba5feb79f22223945d33"></a><!-- doxytag: member="ScrobSubmitter::Start" ref="2cc75a9528f6ba5feb79f22223945d33" args="(std::string artist, std::string track, std::string album, std::string mbId, int length, std::string filename, Encoding encoding=UTF_8)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ScrobSubmitter::Start           </td>
          <td>(</td>
          <td class="paramtype">std::string&nbsp;</td>
          <td class="paramname"> <em>artist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&nbsp;</td>
          <td class="paramname"> <em>track</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&nbsp;</td>
          <td class="paramname"> <em>album</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&nbsp;</td>
          <td class="paramname"> <em>mbId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&nbsp;</td>
          <td class="paramname"> <em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_scrob_submitter.html#743e06902c0318679a3d272f2c0b606a">Encoding</a>&nbsp;</td>
          <td class="paramname"> <em>encoding</em> = <code>UTF_8</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sends a START command to client. All parameter strings are treated as standard char strings.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>artist</em>&nbsp;</td><td>Name of artist. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>track</em>&nbsp;</td><td>Name of track. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>album</em>&nbsp;</td><td>Name of album. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>mbId</em>&nbsp;</td><td>Musicbrainz ID if present. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>length</em>&nbsp;</td><td>Length of track in seconds. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>filename</em>&nbsp;</td><td>Full path to the file on the disk. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>encoding</em>&nbsp;</td><td>Text encoding specifying how to interpret the characters in the strings passed in.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A unique request ID. </dd></dl>

</div>
</div><p>
<a class="anchor" name="566a45131fe2b1420fe01281e0590722"></a><!-- doxytag: member="ScrobSubmitter::Stop" ref="566a45131fe2b1420fe01281e0590722" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ScrobSubmitter::Stop           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sends a STOP command to client. Call this both for stop and when a song plays to the end.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A unique request ID. </dd></dl>

</div>
</div><p>
<a class="anchor" name="96b594065992db4a25d5433ae6847997"></a><!-- doxytag: member="ScrobSubmitter::Pause" ref="96b594065992db4a25d5433ae6847997" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ScrobSubmitter::Pause           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sends a PAUSE command to client. Use this only for pause.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A unique request ID. </dd></dl>

</div>
</div><p>
<a class="anchor" name="eaa7bc7179e4a6c76bbb2a8ca7030aaf"></a><!-- doxytag: member="ScrobSubmitter::Resume" ref="eaa7bc7179e4a6c76bbb2a8ca7030aaf" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ScrobSubmitter::Resume           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sends a RESUME command to client. Should only be used following a preceding START-PAUSE sequence to resume a paused track.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A unique request ID. </dd></dl>

</div>
</div><p>
<a class="anchor" name="22eaa73467e48cb23d69e4191b48c9e8"></a><!-- doxytag: member="ScrobSubmitter::GetVersion" ref="22eaa73467e48cb23d69e4191b48c9e8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string ScrobSubmitter::GetVersion           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get ScrobSub version.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Version string. </dd></dl>

</div>
</div><p>
<a class="anchor" name="2c86769b762ee18c647cd5a6645a579d"></a><!-- doxytag: member="ScrobSubmitter::GetLogPath" ref="2c86769b762ee18c647cd5a6645a579d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string ScrobSubmitter::GetLogPath           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns a suitable directory for putting log files in. Normally "Documents and Settings/[user]/Local Settings/Application Data/ Last.fm/Client".<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Path to log folder. </dd></dl>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_scrob_submitter_8h-source.html">ScrobSubmitter.h</a><li>ScrobSubmitter.cpp</ul>
<hr size="1"><address style="text-align: right;"><small>Generated on Thu Apr 5 14:20:54 2007 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.2 </small></address>
</body>
</html>
